(function(e){function t(t){for(var r,o,i=t[0],c=t[1],l=t[2],u=0,d=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);p&&p(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,i=1;i<a.length;i++){var c=a[i];0!==n[c]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={"store/retail/marketInfoChange":0},s=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var p=c;s.push([40,"chunk-vendors","chunk-common"]),a()})({"37be":function(e,t,a){"use strict";var r=a("c3e6"),n=a.n(r);n.a},40:function(e,t,a){e.exports=a("5b03")},"524a":function(e,t,a){"use strict";(function(e){a("99af"),a("4160"),a("a15b"),a("d81d"),a("a9e3"),a("159b"),a("96cf");var r=a("1da1"),n=a("5530"),s=a("e228"),o=a("0eb8"),i=a("233a"),c=a("9448"),l=a("b9f0"),p=a("d581"),u=a("e60e"),d=a("35ad"),m=a("5a0c"),h=a.n(m);t["a"]={name:"marketInfoChange",components:{applicant:o["a"],pactBaseInfo:c["a"],aptitudeAndRate:l["a"],changeInfoTable:p["a"],Flow:u["d"]},mixins:[s["a"],i["a"]],computed:{position:function(){return this.isEN?this.userInfo.positionEn:this.userInfo.positionCn},orgPathName:function(){return this.isEN?this.userInfo.orgPathNameEn:this.userInfo.orgPathNameCn},dateTime:function(){return h()(new Date).format("YYYY-MM-DD h:mm:ss")},marketInfoColumns:function(){return this.isDetail||"contract"===this.processNode||"legal"===this.processNode?this.marketInfoColumnsRead:this.marketInfoColumnsEditAndRead}},watch:{"contractDetailInfo.changeDate":{handler:function(e){this.infoChangeDate=h()(e).format("YYYY-MM-DD")},immediate:!1}},data:function(){var e=this;return{title:this.$t("infoChangeFlowTitle"),userInfo:JSON.parse(localStorage.getItem("user_info")),isEn:"en-US"===localStorage.getItem("local"),processNode:"retail",slefFormData:{},originChangeFormData:{},marketBaseInfoData:[],marketInfoColumnsEditAndRead:[{type:"index",width:100,title:this.$t("SerialNumber"),key:"SerialNumber"},{title:"主体类型",key:"shopBusinessTypeName"},{title:this.$t("marketCnName"),key:"cnName"},{title:this.$t("marketEnName"),key:"enName"},{title:this.$t("businessLicenseNum"),key:"businessLicenseNo"},{width:150,title:this.$t("action"),key:"shopCode",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small",disabled:!a.row._checked},on:{click:function(){e.readAndEdit(a.index,e.handelType)}}},"infoEdit"===e.handelType||"LegalEdit"===e.handelType?e.$t("btn_edit"):e.$t("watchView"))])}}],marketInfoColumnsRead:[{type:"index",width:100,title:this.$t("SerialNumber"),key:"SerialNumber"},{title:"主体类型",key:"shopBusinessTypeName"},{title:this.$t("marketCnName"),key:"cnName"},{title:this.$t("marketEnName"),key:"enName"},{title:this.$t("businessLicenseNum"),key:"businessLicenseNo"},{width:150,title:this.$t("action"),key:"shopCode",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},on:{click:function(){e.readAndEdit(a.index,"read")}}},e.$t("watchView"))])}}],contractPeriod:{contractBeginDate:"",contractEndDate:""},contractDetailInfo:{changeDate:""},ruleInline:{changeDate:{type:"date",required:!0,message:this.$t("noEmpty"),trigger:"change"}},submitData:{contractBaseInfo:{contractBeginDate:"",contractEndDate:""},marketApproveDetails:[],contractMarketInfos:[],contractDetailInfo:{},oldContractId:"",contractChangeOrFinish:{changeorfinishAttach:""}},validateNotOkFlag:[],defKey:"rcm_contract_market",taskId:"",bizKey:"",instId:"",firstId:"",firstSn:"",needRemark:!1,isContractApprove:!1,isLegalApprove:!1,handelType:"infoEdit",groupMark:0,selfProperty:0,isSelfbusiness:!1,enterpriseNature:"",isDetail:!1,nodeName:"",changeDateOptions:{},changeInfoList:[],hasHistoryApprove:!1,hasHistoryApproveUrl:"",hasHistoryApproveSn:"",hasHistoryApproveDefKey:"",hasHistoryApproveInstId:"",oldContractId:"",hasChooseShop:!1,actualOpenDate:"",currentShopCode:"",ifManagement:"",baseMarketListCopy:Array,flowType:"marketInfoChange",infoChangeDate:"",isExistSame:!1,isPropertyRisk:!1,ifHasWg:!1,baseMarketIsMarketRightList:[]}},created:function(){var e=this.$router2.getQuery(),t=e.taskId,a=e.bizKey,r=e.instId,n=e.nodeName;this.taskId=t,this.bizKey=a,this.instId=r,this.nodeName=n,a&&(this.AddContract(),this.getApproveVPGMData()),this.judgePageType()},methods:{judgePageType:function(){var t=this.$router2.getQuery(),a=t.pageId;a||e.isEmpty(this.$router2.getQuery())||(this.processNode="retailEdit"),"MarketInfoChangeView"===a&&(this.isDetail=!0,this.processNode="retailView",this.handelType="read"),"MarketInfoChangeApprove"===a&&"合同组审核"===this.nodeName&&(this.processNode="contract",this.needRemark=!0,this.isContractApprove=!0,this.handelType="read"),"MarketInfoChangeApproveView"===a&&"合同组审核"===this.nodeName&&(this.isDetail=!0,this.processNode="contract",this.needRemark=!0,this.handelType="read"),"MarketInfoChangeApprove"===a&&"法务组审核"===this.nodeName&&(this.isLegalApprove=!0,this.processNode="legal",this.needRemark=!0,this.handelType="read"),"MarketInfoChangeApproveView"===a&&"法务组审核"===this.nodeName&&(this.isDetail=!0,this.processNode="legal",this.needRemark=!1,this.handelType="read"),"backFromContract"===a&&(this.processNode="backFromContract"),"backFromContractView"===a&&(this.isDetail=!0,this.processNode="retailView",this.handelType="read"),"backFromLegal"===a&&(this.processNode="backFromLegalEdit",this.handelType="LegalEdit")},receiveFormData:function(t){var a=this;if(e.isEmpty(t))return!1;t.contractBaseInfo.ifManagement="",this.slefFormData=t,this.contractDetailInfo.changeDate=this.contractPeriod.contractEndDate;var r=[],s=[];t.baseShopInfo.baseMarketList.forEach((function(e){1===Number(e.shopBusinessType)?r.push(e):s.push(e)})),this.ifHasWg=!!s.length,t.baseShopInfo.baseMarketList=this.bubbleSortFn(r,"ranking").concat(s),this.formData.baseMarketList=t.baseShopInfo.baseMarketList.map((function(e){return Object(n["a"])({_checked:!a.ifHasWg,shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})),this.baseMarketListCopy=e.cloneDeep(this.formData.baseMarketList),Number(this.slefFormData.baseShopInfo.isSelf)?this.isSelfbusiness=!0:this.isSelfbusiness=!1,this.hasChooseShop=!0,this.oldContractId=t.contractBaseInfo.id,this.currentShopCode=t.contractBaseInfo.shopCode,this.getHistoryApproveInfoFn(t.contractBaseInfo.shopCode)},AddContract:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var r,s,o,i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={id:"",sn:t.bizKey},a.next=3,Object(d["g"])(r);case 3:s=a.sent,200===s.code&&(t.slefFormData=s.data,o=s.data.contractDetailInfo,i=o?o.changeDate:"",t.infoChangeDate=t.contractDetailInfo.changeDate=i?h()(i).format("YYYY-MM-DD"):"",t.ifHasWg=!1,t.formData.baseMarketList=s.data.contractMarketInfos.map((function(e){return"1"!==e.shopBusinessType&&(t.ifHasWg=!0),Object(n["a"])({_checked:!1,shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})),t.baseMarketListCopy=e.cloneDeep(t.formData.baseMarketList),t.hasChooseShop=!0,t.getHistoryApproveInfoFn(s.data.contractBaseInfo.shopCode),t.currentShopCode=s.data.contractBaseInfo.shopCode,t.oldContractId=s.data.contractBaseInfo.id,s.data.marketApproveDetails.forEach((function(e){"cqxx"===e.approveItemCode&&"cqxx_1"===e.approveLevelId&&(t.isPropertyRisk=!0)})),c=s.data.contractBaseInfo.ifManagement,t.emitIfManagement(c),t.getOriginalStoreInfo(s.data.contractBaseInfo.shopCode));case 5:case"end":return a.stop()}}),a)})))()},getOriginalStoreInfo:function(t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){var s,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s={shopCode:t,sn:""},r.next=3,Object(d["h"])(s);case 3:o=r.sent,200===o.code&&(i=o.data.baseShopInfo.baseMarketList.map((function(e,t){var r=1===Number(e.isActualmarketRight);return a.baseMarketIsMarketRightList.$set(t,r),Object(n["a"])({_checked:!1,shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})),a.baseMarketListCopy=e.cloneDeep(i),o.data.contractBaseInfo.ifManagement="",a.originChangeFormData=o.data);case 5:case"end":return r.stop()}}),r)})))()},submitFormData:function(e,t,a){"contractBaseInfo"===t&&(this.submitData.oldContractId=e.id,Object.assign(this.submitData.contractBaseInfo,e),this.submitData.contractChangeOrFinish.changeorfinishAttach=e.changeorfinishAttach,this.submitData.contractBaseInfo.contractApproveBeginDate=this.commonFormat(this.contractPeriod.contractApproveBeginDate),"retail"===this.processNode&&(this.firstSn?(this.submitData.contractBaseInfo.sn=this.firstSn,this.submitData.contractBaseInfo.id=this.firstId):(e.hasOwnProperty("sn")&&(this.submitData.contractBaseInfo.sn=""),e.hasOwnProperty("id")&&(this.submitData.contractBaseInfo.id="")))),"apitude"===t&&(Object.assign(this.submitData.marketApproveDetails,e),Object.assign(this.submitData.contractDetailInfo,a)),"rateMark"===t&&Object.assign(this.submitData.contractDetailInfo,e)},validateNotOk:function(e){this.validateNotOkFlag.push(e)},validateChangeDate:function(e){var t=this;e?this.$refs.pactPeriodAndchangeTime.validate((function(e){e?t.submitData.contractDetailInfo.changeDate=t.contractDetailInfo.changeDate:t.validateNotOk(!1)})):this.submitData.contractDetailInfo.changeDate=this.contractDetailInfo.changeDate},saveRetailInfo:function(){this.submitData.contractBaseInfo.applicantName=this.userInfo.userName,this.submitData.contractBaseInfo.applicantPosition=this.position,this.submitData.contractBaseInfo.applicantEmail=this.userInfo.email,this.submitData.contractBaseInfo.applicantCode=this.userInfo.userCode,this.submitData.contractBaseInfo.applicantMobile=this.userInfo.mobile,this.submitData.contractBaseInfo.applicationDate=this.dateTime,this.submitData.contractBaseInfo.applicantOrgPath=this.orgPathName,this.submitData.contractBaseInfo.applicantOrgPathCode=this.userInfo.orgPathCode},changeMarketInfoFn:function(t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){var n,s,o,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.validateNotOkFlag=[],r.next=3,a.$refs.pactBaseInfo.emitData(t);case 3:if(a.validateChangeDate(t),n=["businessLicense","openingPermit","landUsePermits","constructionPermits","houseOwnership","ortherPermits","actualBusinessLicense","actualOpeningPermit","actualLandUsePermits","actualConstructionPermits","actualHouseOwnership","actualOrtherPermits","actualAuthCertificate","authCertificate"],"retail"===a.processNode&&a.saveRetailInfo(),s=e.cloneDeep(a.formData.baseMarketList),a.submitData.contractMarketInfos=s.map((function(e){for(var t=0;t<n.length;t++)Array.isArray(e[n[t]])&&(e[n[t]]=e[n[t]].map((function(e){return e.id})),e[n[t]]=e[n[t]].join(",")),Array.isArray(e.settledBrandsCode)&&(e.settledBrandsCode=e.settledBrandsCode.join(","));return e})),o=[],a.submitData.contractBaseInfo.changeorfinishAttach&&a.submitData.contractBaseInfo.changeorfinishAttach.length&&(o=a.submitData.contractBaseInfo.changeorfinishAttach.map((function(e){return e.id}))),a.submitData.contractBaseInfo.changeorfinishAttach=o.join(","),a.submitData.contractChangeOrFinish.changeorfinishAttach=o.join(","),a.changeMarketInfoListFn(),a.$refs.aptitudeAndRate.emitData(),!t||a.validateNotOkFlag.length){r.next=22;break}return r.next=17,Object(d["c"])(a.submitData);case 17:return i=r.sent,200===i.code&&(a.firstSn||(a.firstSn=i.data.sn,a.firstId=i.data.id)),r.abrupt("return",i);case 22:if(!t||!a.validateNotOkFlag.length){r.next=26;break}return a.$Spin.hide(),a.$Message.error({content:"必填项缺失",duration:a.$global.duration,closable:!0}),r.abrupt("return",!1);case 26:if(t){r.next=32;break}return r.next=29,Object(d["c"])(a.submitData);case 29:return c=r.sent,200===c.code&&(a.firstSn||(a.firstSn=c.data.sn,a.firstId=c.data.id),a.getApproveVPGMData()),r.abrupt("return",c);case 32:case"end":return r.stop()}}),r)})))()},linkToHistoryApprove:function(){var e=this.$router2.resolve.call(this,{path:this.hasHistoryApproveUrl,query:{bizKey:this.hasHistoryApproveSn,pageFrom:"alreadyDone",defKey:this.hasHistoryApproveDefKey,instId:this.hasHistoryApproveInstId}});window.open(e,"_blank")},getHistoryApproveInfoFn:function(t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(d["e"])({shopCode:t});case 2:n=r.sent,200!==n.code||e.isEmpty(n.data)||(a.hasHistoryApprove=!0,a.hasHistoryApproveUrl=n.data.url,a.hasHistoryApproveSn=n.data.sn,a.hasHistoryApproveDefKey=n.data.defKey,a.hasHistoryApproveInstId=n.data.instId);case 4:case"end":return r.stop()}}),r)})))()},onFlowBefore:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var r,n,s,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.cmdType,n=e.cmdId,"processStatus"===r){a.next=33;break}if("legal"!==t.processNode||""!==t.$refs.flow.$data.taskComment||!t.isPropertyRisk){a.next=5;break}return t.$Message.warning({content:"请输入审核意见",duration:t.$global.duration,closable:!0}),a.abrupt("return",{interrupted:!0,value:t.bizKey});case 5:if(t.handleSpinCustom(),!("saveTaskDraft"===r||"submit"===r&&"submit"===n||"legal"!==t.processNode&&"rollBackTask"===n&&"general"===r||"general"===r&&"needLegal"===n||"general"===r&&"noLegal"===n||"general"===r&&"reSubmit"===n||"general"===r&&"HandleCommand_4"===n||"general"===r&&"HandleCommand_3"===n)){a.next=32;break}if(o="submit"===r&&"submit"===n||"general"===r&&"reSubmit"===n||"general"===r&&"HandleCommand_3"===n,!o){a.next=14;break}return a.next=11,t.changeMarketInfoFn(1);case 11:s=a.sent,a.next=17;break;case 14:return a.next=16,t.changeMarketInfoFn(0);case 16:s=a.sent;case 17:if(!s||!s.code||200!==s.code){a.next=20;break}return i=t.bizKey?t.bizKey:t.firstSn,a.abrupt("return",{interrupted:!1,value:i});case 20:if(!s||!s.code||200===s.code){a.next=24;break}return t.$Spin.hide(),t.$Message.warning({content:s.message,duration:t.$global.duration,closable:!0}),a.abrupt("return",{interrupted:!0});case 24:if("服务器内部错误"!==s){a.next=28;break}return t.$Spin.hide(),t.$Message.warning({content:s,duration:t.$global.duration,closable:!0}),a.abrupt("return",{interrupted:!0});case 28:if(s){a.next=30;break}return a.abrupt("return",{interrupted:!0});case 30:a.next=33;break;case 32:return a.abrupt("return",{interrupted:!1});case 33:case"end":return a.stop()}}),a)})))()},onFlowError:function(e){this.$Spin.hide(),this.$Message.warning({content:e,duration:this.$global.duration,closable:!0})},onFlowFinish:function(){},onFlowResult:function(e){var t=this,a=(e.instId,e.taskId,e.cmdId),r=e.cmdType;this.$Spin.hide(),"saveTaskDraft"===r?this.$rcmMessage.show({content:this.$t("temporarySuccess")}):"submit"===r&&"submit"===a||"general"===r&&"reSubmit"===a||"general"===r&&"HandleCommand_3"===a||"general"===r&&"HandleCommand_4"===a?this.$rcmMessage.show({onOk:function(){t.$router2.push.call(t,"/wflow/my")}}):"general"===r&&"needLegal"===a?this.$rcmMessage.show({onOk:function(){t.$router2.push.call(t,"/wflow/processed")}}):"rollBackTask"===a&&"general"===r?this.$rcmMessage.show({content:this.$t("returnedSucc"),onOk:function(){t.$router2.push.call(t,"/wflow/processed")}}):"noLegal"===a&&"general"===r||"legalAgree"===a&&"general"===r?this.$rcmMessage.show({content:this.$t("success"),onOk:function(){t.$router2.push.call(t,"/wflow/processed")}}):"terminationProcess"===r&&this.$rcmMessage.show({content:this.$t("TerminationSuccess"),onOk:function(){t.$router2.push.call(t,"/wflow/my")}})},getApproveVPGMData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.firstSn){t.next=6;break}return t.next=3,Object(d["b"])({sn:e.firstSn});case 3:a=t.sent,t.next=9;break;case 6:return t.next=8,Object(d["b"])({sn:e.bizKey});case 8:a=t.sent;case 9:200===a.code&&(e.changeInfoList=a.data.changeInformation);case 10:case"end":return t.stop()}}),t)})))()},emitIfManagement:function(e){switch(this.ifManagement=e,e){case"0":this.formData.baseMarketList.forEach((function(e){1!==Number(e.shopBusinessType)?e._checked=!1:e._checked=!0}));break;case"1":this.formData.baseMarketList.forEach((function(e){1===Number(e.shopBusinessType)?e._checked=!1:e._checked=!0}));break;case"2":this.formData.baseMarketList.forEach((function(e){e._checked=!0}));break}},handleSpinCustom:function(){this.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","Loading")])}})},bubbleSortFn:function(e,t){for(var a=0;a<e.length;a++)for(var r=0;r<e.length-a-1;r++)if(Number(e[r][t])>Number(e[r+1][t])){var n=e[r];e[r]=e[r+1],e[r+1]=n}return e}},mounted:function(){document.title=this.title}}}).call(this,a("2ef0"))},"5b03":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("cc00"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-container marketInfoChange"},[a("form-header",{attrs:{title:e.title,"serial-number":e.formData.sn}}),a("Card",{attrs:{title:e.$t("applicant")}},["retail"===e.processNode?a("applicant"):a("applicant",{attrs:{applicantData:e.slefFormData.contractBaseInfo}})],1),a("Card",{attrs:{title:e.$t("baseStoreInfo")}},[a("pact-base-info",{ref:"pactBaseInfo",attrs:{processNode:e.processNode,isSelfList:e.isSelfList,yesornoList:e.yesornoList,AllShopPropertiesDictList:e.AllShopPropertiesDictList,currencyList:e.currencyList,marketEnterpriseNatureList:e.marketEnterpriseNatureList,marketTypeList:e.marketTypeList,contractVersionList:e.contractVersionList,relationshipsWithOtherBrandsList:e.relationshipsWithOtherBrandsList,relateBrandsList:e.relateBrandsList,changeFormData:e.slefFormData,ifHasWg:e.ifHasWg},on:{emitFormData:e.receiveFormData,submitFormData:e.submitFormData,validateNotOk:e.validateNotOk,emitIfManagement:e.emitIfManagement}})],1),a("Card",{attrs:{title:e.$t("storeInfo")}},[a("Form",{ref:"pactPeriodAndchangeTime",staticClass:"form",attrs:{"label-width":120,model:e.contractDetailInfo,rules:e.ruleInline,"label-position":"left",inline:""}},[a("FormItem",{staticClass:"form-item",attrs:{"label-width":160,label:e.$t("marketInfoUpdateTime"),prop:"changeDate"}},[a("DatePicker",{attrs:{type:"date",disabled:"retailEdit"!==e.processNode&&"retail"!==e.processNode&&"backFromContract"!==e.processNode,placeholder:e.$t("wran_slt")},model:{value:e.contractDetailInfo.changeDate,callback:function(t){e.$set(e.contractDetailInfo,"changeDate",t)},expression:"contractDetailInfo.changeDate"}})],1),a("FormItem",{staticClass:"form-item"})],1),a("Table",{staticClass:"marketInfoTable",attrs:{columns:e.marketInfoColumns,data:e.formData.baseMarketList,border:""}}),e.hasChooseShop?a("div",{staticStyle:{"margin-top":"10px"}},[e.hasHistoryApprove?a("Button",{on:{click:e.linkToHistoryApprove}},[e._v("资质审批表链接")]):a("Button",{attrs:{disabled:""}},[e._v("无资质审批表链接")])],1):e._e()],1),a("aptitude-and-rate",{ref:"aptitudeAndRate",attrs:{defKey:e.defKey,instId:e.instId,isDetail:e.isDetail,processNode:e.processNode,changeFormData:e.slefFormData,originChangeFormData:e.originChangeFormData,isSelfbusiness:e.isSelfbusiness,changeDate:e.infoChangeDate,selfProperty:e.selfProperty,yesornoList:e.yesornoList,enterpriseNature:e.enterpriseNature,marketEnterpriseNatureList:e.marketEnterpriseNatureList,baseMarketList:e.formData.baseMarketList,isContractApprove:e.isContractApprove,isLegalApprove:e.isLegalApprove,actualOpenDate:e.actualOpenDate,ifManagement:e.ifManagement,hasHistoryApprove:e.hasHistoryApprove},on:{submitFormData:e.submitFormData}}),e.modal1?a("main-store",{ref:"mis",attrs:{isExistSame:e.isExistSame,oldBaseMarketList:e.formDataBaseMarketList,mode:e.mode1,index:e.index,processNode:e.processNode,flowType:e.flowType,baseMarketIsMarketRightList:e.baseMarketIsMarketRightList},on:{cancel:function(t){return e.addMainStore(!1)},storeSubmit:e.storeSubmit},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}}):e._e(),e.modal2?a("add-mate-store",{ref:"mes",attrs:{oldBaseMarketList:e.formDataBaseMarketList,mode:e.mode2,index:e.index,flowType:e.flowType},on:{cancel:function(t){return e.addMateStore(!1)},storeSubmit:e.storeSubmit},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}}):e._e(),a("Card",{attrs:{title:e.$t("marketChangeStatus")}},[a("change-info-table",{attrs:{shopInfoChangeList:e.changeInfoList}})],1),a("BackTop"),a("div",[e.isDetail?e._e():a("Flow",{ref:"flow",attrs:{defKey:e.defKey,remarkTitle:e.$t("RemarkVerify"),uploadAble:!0,initialTaskId:e.taskId,initialBizKey:e.bizKey,initialInstId:e.instId,onFlowBefore:e.onFlowBefore,onFlowFinish:e.onFlowFinish,onFlowError:e.onFlowError,onFlowResult:e.onFlowResult,componentConf:{history:{visible:!1},attachment:{visible:!1},remark:{visible:e.needRemark}}}})],1)],1)},s=[],o=a("524a"),i=o["a"],c=(a("37be"),a("2877")),l=Object(c["a"])(i,n,s,!1,null,null,null),p=l.exports,u=a("fe07");r["a"].config.productionTip=!1,new r["a"]({i18n:u["a"],render:function(e){return e(p)}}).$mount("#app")},"7a4c":function(e,t,a){},9448:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Form",{ref:"formData",staticClass:"form",attrs:{"label-width":120,model:e.formData,rules:e.ruleInline,"label-position":"right",inline:""}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("shopCode")}},[a("form-mode",{attrs:{columns:e.shopCodeColumns,searchData:e.shopSearchData,apiFun:e.getListData,filterItem:"",disabled:"retail"!==e.processNode},on:{select:e.storeCodeSelect}},[a("Input",{attrs:{icon:"ios-arrow-down",size:"large",disabled:"retail"!==e.processNode},model:{value:e.formData.shopCode,callback:function(t){e.$set(e.formData,"shopCode",t)},expression:"formData.shopCode"}})],1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:"店铺名称",prop:"shopName"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.formData.shopName,callback:function(t){e.$set(e.formData,"shopName",t)},expression:"formData.shopName"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("isSelf"),prop:"isSelf"}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.formData.isSelf,callback:function(t){e.$set(e.formData,"isSelf",t)},expression:"formData.isSelf"}},e._l(e.yesornoList,(function(t,r){return a("Option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("shopNatureCode")}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.formData.shopNatureCode,callback:function(t){e.$set(e.formData,"shopNatureCode",t)},expression:"formData.shopNatureCode"}},e._l(e.AllShopPropertiesDictList,(function(t,r){return a("Option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("brandCode"),prop:"brand"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.formData.brand,callback:function(t){e.$set(e.formData,"brand",t)},expression:"formData.brand"}})],1)],1),a("Col",{attrs:{span:"8"}},[e.isEn?a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("companyNameEn"),prop:"companyName"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.formData.companyEnName,callback:function(t){e.$set(e.formData,"companyEnName",t)},expression:"formData.companyEnName"}})],1):a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("companyName"),prop:"companyName"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.formData.companyName,callback:function(t){e.$set(e.formData,"companyName",t)},expression:"formData.companyName"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("marketName")}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.formData.marketName,callback:function(t){e.$set(e.formData,"marketName",t)},expression:"formData.marketName"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("businessNature"),prop:"enterpriseNature"}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.formData.enterpriseNature,callback:function(t){e.$set(e.formData,"enterpriseNature",t)},expression:"formData.enterpriseNature"}},e._l(e.marketEnterpriseNatureList,(function(t,r){return a("Option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("marketType"),prop:"marketType"}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.formData.marketType,callback:function(t){e.$set(e.formData,"marketType",t)},expression:"formData.marketType"}},e._l(e.marketTypeList,(function(t,r){return a("Option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("currency"),prop:"currency"}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.formData.currency,callback:function(t){e.$set(e.formData,"currency",t)},expression:"formData.currency"}},e._l(e.currencyList,(function(t,r){return a("Option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"16"}},[a("FormItem",{staticClass:"form-item shopAddress",attrs:{label:e.$t("storeAddress"),prop:"storeAddress"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.formData.shopAddress,callback:function(t){e.$set(e.formData,"shopAddress",t)},expression:"formData.shopAddress"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("isNeedRatifyContract"),prop:"isNeedSignatoryAttach"}},[a("Select",{attrs:{size:"large",disabled:e.isDisabled},on:{"on-change":e.changeIsNeedSignatoryAttach},model:{value:e.formData.isNeedSignatoryAttach,callback:function(t){e.$set(e.formData,"isNeedSignatoryAttach",t)},expression:"formData.isNeedSignatoryAttach"}},e._l(e.yesornoList,(function(t,r){return a("Option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("uploadAttachments"),required:e.upFileIsQuired,prop:"changeorfinishAttach"}},[a("unload-file",{attrs:{column:e.fileColumn},on:{updateFile:e.updateFile,deleteFile:e.deleteFile}})],1)],1),e.ifHasWg?a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("ifManagement"),required:!0}},[a("Select",{attrs:{size:"large",disabled:e.isDisabled},on:{"on-change":e.changeIfManagement},model:{value:e.formData.ifManagement,callback:function(t){e.$set(e.formData,"ifManagement",t)},expression:"formData.ifManagement"}},e._l(e.changeStoreList,(function(t,r){return a("Option",{key:r,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1):e._e()],1)],1)],1)},n=[],s=(a("4160"),a("a434"),a("a9e3"),a("b64b"),a("159b"),a("2909")),o=(a("96cf"),a("1da1")),i=a("35ad"),c=a("73f5"),l=a("1f4f"),p=a("6936"),u={name:"pactBaseInfo",components:{FormMode:l["a"],unloadFile:p["a"]},props:{processNode:{type:String,required:!1,default:"retail"},isSelfList:{type:Array,required:!1,default:function(){return[]}},yesornoList:{type:Array,required:!1,default:function(){return[]}},AllShopPropertiesDictList:{type:Array,required:!1,default:function(){return[]}},currencyList:{type:Array,required:!1,default:function(){return[]}},marketEnterpriseNatureList:{type:Array,required:!1,default:function(){return[]}},marketTypeList:{type:Array,required:!1,default:function(){return[]}},relationshipsWithOtherBrandsList:{type:Array,required:!1,default:function(){return[]}},contractVersionList:{type:Array,required:!1,default:function(){return[]}},changeFormData:{type:Object,required:!1,default:function(){return{}}},ifHasWg:{type:Boolean,required:!1,default:function(){return!1}}},data:function(){var e=this,t=function(t,a,r){e.upFileIsQuired&&0===!e.formData.changeorfinishAttach.length&&r(new Error(e.$t("noEmpty"))),r()};return{isEn:"en-US"===localStorage.getItem("local"),formData:{shopCode:"",shopName:"",isSelf:"",currency:"",companyName:"",brand:"",shopAddress:"",marketName:"",enterpriseNature:"",marketType:"",shopNatureCode:"",contractCode:"",changeorfinishAttach:[],isNeedSignatoryAttach:"",ifManagement:"",id:"",sn:"",applicantCode:"",applicantName:"",applicantMobile:"",applicantPositionCode:"",applicantPosition:"",applicantDutiesCode:"",applicantDuties:"",applicantEmail:"",applicantOrgPathCode:"",applicantOrgPath:"",applicationDate:""},ruleInline:{isNeedSignatoryAttach:{required:!0,message:this.$t("noEmpty"),trigger:"change"},changeorfinishAttach:{validator:t,trigger:"change"},ifManagement:{message:this.$t("noEmpty"),trigger:"change"}},shopCodeColumns:[{title:"店铺代码",key:"shopCode"},{title:"店铺名称",key:"shopName"}],getListData:c["D"],shopSearchData:{physicalCity:"",shopName:"",shopCode:"",shopNatureCode:""},upFileIsShow:!1,onceFlag:!0,upFileIsQuired:!1,enable:!0,changeStoreList:[{code:"0",type:"yesorno",valueCN:"只变更主体",valueEn:"YES",parentCode:"",description:"是否",orderBy:0,id:445,value:"只变更主体"},{code:"1",type:"yesorno",valueCN:"只变更物管",valueEn:"NO",parentCode:"446",description:"是否",orderBy:1,id:446,value:"只变更物管"},{code:"2",type:"yesorno",valueCN:"主体、物管都变更",valueEn:"NO",parentCode:"446",description:"是否",orderBy:1,id:446,value:"主体、物管都变更"}]}},computed:{fileColumn:function(){return{required:!0,validOk:!0,enable:this.enable,multiple:!0,files:this.formData.changeorfinishAttach}}},watch:{changeFormData:{handler:function(e){if(e.contractBaseInfo&&e.baseShopInfo){this.formData=e.contractBaseInfo;var t=e.baseShopInfo,a=t.shopCode,r=t.shopName,n=t.isSelf,s=t.shopNatureCode,o=t.brand,i=t.companyName,c=t.marketName;this.formData.shopCode=a,this.formData.shopName=r,this.formData.isSelf=n+"",this.formData.shopNatureCode=s,this.formData.brand=o,this.formData.companyName=i,this.formData.marketName=c,this.formData.currency=e.currency;var l=e.contractBaseInfo,p=l.enterpriseNature,u=l.marketType,d=l.shopAddress,m=l.isNeedSignatoryAttach,h=l.changeorfinishAttach,f=l.ifManagement,g=l.id,b=l.sn,D=l.applicantCode,y=l.applicantName,k=l.applicantMobile,I=l.applicantPositionCode,v=l.applicantPosition,C=l.applicantDutiesCode,N=l.applicantDuties,S=l.applicantEmail,w=l.applicantOrgPathCode,A=l.applicantOrgPath,$=l.applicationDate;this.formData.enterpriseNature=p,this.formData.marketType=u,this.formData.shopAddress=d,this.formData.isNeedSignatoryAttach=m,this.formData.ifManagement=f,this.formData.id=g,this.formData.sn=b,this.formData.applicantCode=D,this.formData.applicantName=y,this.formData.applicantMobile=k,this.formData.applicantPositionCode=I,this.formData.applicantPosition=v,this.formData.applicantDutiesCode=C,this.formData.applicantDuties=N,this.formData.applicantEmail=S,this.formData.applicantOrgPathCode=w,this.formData.applicantOrgPath=A,this.formData.applicationDate=$,this.formData.changeorfinishAttach=Array.isArray(h)?h:[]}},immediate:!0},processNode:{handler:function(e){"retail"===this.processNode||"retailEdit"===this.processNode||"backFromContract"===this.processNode?(this.enable=!0,this.isDisabled=!1):(this.enable=!1,this.isDisabled=!0)},immediate:!0},"formData.isNeedSignatoryAttach":{handler:function(e){Number(e)?this.upFileIsQuired=!0:this.upFileIsQuired=!1},immediate:!0}},methods:{oriData:function(e,t){Object.keys(t).forEach((function(a){t[a]=e[a]}))},storeCodeSelect:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["G"])({shopCode:e.shopCode});case 2:if(r=a.sent,500!==r.code){a.next=6;break}return t.$Message.warning({content:r.message||"该店铺已在流程中",duration:t.$global.duration,closable:!0}),a.abrupt("return",!1);case 6:return t.formData.shopCode=e.shopCode,n={shopCode:e.shopCode,sn:""},a.next=10,Object(i["h"])(n);case 10:s=a.sent,200===s.code?t.$emit("emitFormData",s.data):(t.$emit("emitFormData",{}),t.$Message.error({content:s.message,duration:t.$global.duration,closable:!0}));case 12:case"end":return a.stop()}}),a)})))()},emitData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e){a.next=7;break}return a.next=3,t.$refs.formData.validate();case 3:r=a.sent,r?t.$emit("submitFormData",t.formData,"contractBaseInfo"):t.$emit("validateNotOk",!1),a.next=8;break;case 7:t.$emit("submitFormData",t.formData,"contractBaseInfo");case 8:case"end":return a.stop()}}),a)})))()},updateFile:function(e){var t;(t=this.formData.changeorfinishAttach).push.apply(t,Object(s["a"])(e.files))},deleteFile:function(e){this.formData.changeorfinishAttach.splice(e.fileIndex,1)},changeIsNeedSignatoryAttach:function(e){Number(e)?(this.$refs.formData.validateField("isNeedSignatoryAttach"),this.upFileIsQuired=!0):(this.$refs.formData.validateField("isNeedSignatoryAttach"),this.upFileIsQuired=!1,this.$refs.formData.validateField("changeorfinishAttach"))},changeIfManagement:function(e){this.$emit("emitIfManagement",e)}},created:function(){},mounted:function(){}},d=u,m=(a("aae5"),a("2877")),h=Object(m["a"])(d,r,n,!1,null,null,null);t["a"]=h.exports},aae5:function(e,t,a){"use strict";var r=a("7a4c"),n=a.n(r);n.a},c3e6:function(e,t,a){}});