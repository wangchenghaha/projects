(function(e){function t(t){for(var s,o,i=t[0],c=t[1],l=t[2],u=0,p=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);d&&d(t);while(p.length)p.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,i=1;i<a.length;i++){var c=a[i];0!==r[c]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},r={"store/retail/marketMainChange":0},n=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;n.push([41,"chunk-vendors","chunk-common"]),a()})({41:function(e,t,a){e.exports=a("a29b")},"5a0c5":function(e,t,a){"use strict";var s=a("cca1"),r=a.n(s);r.a},a29b:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("cc00"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-container"},[a("form-header",{attrs:{title:e.title}}),a("Card",{attrs:{title:e.$t("applicant")}},["retail"===e.processNode?a("applicant"):a("applicant",{attrs:{applicantData:e.contractBaseInfo}})],1),a("Card",{attrs:{title:e.$t("pactBaseInfo")}},[a("Form",{ref:"contractBaseInfo",staticClass:"form",attrs:{"label-width":120,model:e.contractBaseInfo,rules:e.ruleInline1,"label-position":"right",inline:""}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("shopCode")}},[a("form-mode",{attrs:{columns:e.shopCodeColumns,searchData:e.shopSearchData,apiFun:e.getListData,filterItem:e.filterItem,disabled:e.isDetail||"retail"!==e.processNode},on:{select:e.storeCodeSelect}},[a("Input",{attrs:{icon:"ios-arrow-down",size:"large",disabled:e.isDetail||"retail"!==e.processNode},model:{value:e.contractBaseInfo.shopCode,callback:function(t){e.$set(e.contractBaseInfo,"shopCode",t)},expression:"contractBaseInfo.shopCode"}})],1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:"店铺名称",prop:"shopName"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.shopName,callback:function(t){e.$set(e.contractBaseInfo,"shopName",t)},expression:"contractBaseInfo.shopName"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("isSelf"),prop:"isSelf"}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.isSelf,callback:function(t){e.$set(e.contractBaseInfo,"isSelf",t)},expression:"contractBaseInfo.isSelf"}},e._l(e.yesornoList,(function(t,s){return a("Option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("shopNatureCode")}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.shopNatureCode,callback:function(t){e.shopNatureCode=t},expression:"shopNatureCode"}},e._l(e.AllShopPropertiesDictList,(function(t,s){return a("Option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("brandCode"),prop:"brand"}},[a("Input",{attrs:{disabled:"",size:"large"},model:{value:e.contractBaseInfo.brand,callback:function(t){e.$set(e.contractBaseInfo,"brand",t)},expression:"contractBaseInfo.brand"}})],1)],1),a("Col",{attrs:{span:"8"}},[e.isEn?a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("companyNameEn"),prop:"companyName"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.companyEnName,callback:function(t){e.$set(e.contractBaseInfo,"companyEnName",t)},expression:"contractBaseInfo.companyEnName"}})],1):a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("companyName"),prop:"companyName"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.companyName,callback:function(t){e.$set(e.contractBaseInfo,"companyName",t)},expression:"contractBaseInfo.companyName"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("marketName"),prop:"marketName"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.marketName,callback:function(t){e.$set(e.contractBaseInfo,"marketName",t)},expression:"contractBaseInfo.marketName"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("businessNature")}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.enterpriseNature,callback:function(t){e.$set(e.contractBaseInfo,"enterpriseNature",t)},expression:"contractBaseInfo.enterpriseNature"}},e._l(e.marketEnterpriseNatureList,(function(t,s){return a("Option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("marketType"),prop:"marketType"}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.marketType,callback:function(t){e.$set(e.contractBaseInfo,"marketType",t)},expression:"contractBaseInfo.marketType"}},e._l(e.marketTypeList,(function(t,s){return a("Option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("currency"),prop:"currency"}},[a("Select",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.currency,callback:function(t){e.$set(e.contractBaseInfo,"currency",t)},expression:"contractBaseInfo.currency"}},e._l(e.currencyList,(function(t,s){return a("Option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"16"}},[a("FormItem",{staticClass:"form-item storeAddress",attrs:{label:e.$t("storeAddress"),prop:"storeAddress"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.contractBaseInfo.shopAddress,callback:function(t){e.$set(e.contractBaseInfo,"shopAddress",t)},expression:"contractBaseInfo.shopAddress"}})],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("isNeedRatifyContract"),prop:"isNeedSignatoryAttach"}},[a("Select",{attrs:{size:"large",disabled:e.isDisabled},on:{"on-change":e.changeIsNeedSignatoryAttach},model:{value:e.contractBaseInfo.isNeedSignatoryAttach,callback:function(t){e.$set(e.contractBaseInfo,"isNeedSignatoryAttach",t)},expression:"contractBaseInfo.isNeedSignatoryAttach"}},e._l(e.yesornoList,(function(t,s){return a("Option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:e.$t("uploadAttachments"),required:e.upFileIsQuired,prop:"changeorfinishAttach"}},[a("unload-file",{attrs:{column:e.fileColumn},on:{updateFile:e.updateFile,deleteFile:e.deleteFile}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item width90",attrs:{label:"变更情况",prop:"ifManagement"}},[a("Select",{attrs:{size:"large",disabled:e.isDisabled},on:{"on-change":e.changeIsOnlyChangeWuGuan},model:{value:e.contractBaseInfo.ifManagement,callback:function(t){e.$set(e.contractBaseInfo,"ifManagement",t)},expression:"contractBaseInfo.ifManagement"}},e._l(e.changeStoreList,(function(t,s){return a("Option",{key:s,attrs:{value:t.code}},[e._v(e._s(t.value))])})),1)],1)],1)],1)],1)],1),a("Card",{attrs:{title:e.$t("oldConstractInfo")}},[a("Table",{staticClass:"marketInfoTable",attrs:{columns:e.oldMarketInfoColumns,data:e.formData.oldBaseMarketList,border:""}})],1),a("Card",{attrs:{title:e.$t("unclosedItem")}},[a("unclosed-items",{attrs:{shopCode:e.shopCode,bizKey:e.bizKey}})],1),a("Card",{attrs:{title:e.$t("mainUpdateTime")}},[a("Row",[a("Col",[a("Form",{ref:"pactPeriodAndchangeTime",staticClass:"form",attrs:{model:e.contractDetailInfo,rules:e.ruleInline2,"label-width":120,"label-position":"right",inline:""}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("mainUpdateTime"),prop:"changeDate"}},[a("DatePicker",{attrs:{type:"date",placeholder:e.$t("wran_slt"),disabled:e.isDetail||"retailEdit"!==e.processNode&&"retail"!==e.processNode&&"backFromContractEdit"!==e.processNode},model:{value:e.contractDetailInfo.changeDate,callback:function(t){e.$set(e.contractDetailInfo,"changeDate",t)},expression:"contractDetailInfo.changeDate"}})],1)],1)],1)],1)],1),a("Card",{attrs:{title:e.$t("afterChangeMainInfo")}},[a("Table",{staticClass:"marketInfoTable",attrs:{columns:e.marketInfoColumns,data:e.formData.baseMarketList,border:""}}),e.hasChooseShop?a("div",{staticStyle:{"margin-top":"10px"}},[e.hasHistoryApprove?a("Button",{on:{click:e.linkToHistoryApprove}},[e._v("资质审批表链接")]):a("Button",{attrs:{disabled:""}},[e._v("无资质审批表链接")])],1):e._e()],1),a("aptitude-and-rate",{ref:"aptitudeAndRate",attrs:{isMarketMainChange:e.isMarketMainChange,processNode:e.processNode,changeFormData:e.selfFormData,originChangeFormData:e.originChangeFormData,isSelfbusiness:e.isSelfbusiness,selfProperty:e.selfProperty,yesornoList:e.yesornoList,changeDate:e.mainChangeDate,enterpriseNature:e.enterpriseNature,marketEnterpriseNatureList:e.marketEnterpriseNatureList,baseMarketList:e.formData.baseMarketList,isDetail:e.isDetail,isContractApprove:e.isContractApprove,isLegalApprove:e.isLegalApprove,ifManagement:e.ifManagement},on:{submitFormData:e.submitFormData}}),e.modal1?a("main-store",{ref:"mis",attrs:{defKey:"rcm_contract_main_market",baseMarketList:e.formDataBaseMarketList,oldBaseMarketList:e.formDataOldBaseMarketList,processNode:e.processNode,mode:e.mode1,index:e.index,isAddMarket:e.isAddMarket,ifManagement:e.ifManagement,isExistSame:e.isExistSame},on:{cancel:function(t){return e.addMainStore(!1)},storeSubmit:e.storeSubmit},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}}):e._e(),e.modal2?a("add-mate-store",{ref:"mes",attrs:{baseMarketList:e.formDataBaseMarketList,oldBaseMarketList:e.formDataOldBaseMarketList,mode:e.mode2,index:e.index,isAddMarket:e.isAddMarket},on:{cancel:function(t){return e.addMateStore(!1)},storeSubmit:e.storeSubmit},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}}):e._e(),a("BackTop"),a("div",[e.isDetail?e._e():a("Flow",{ref:"flow",attrs:{defKey:"rcm_contract_main_market",remarkTitle:e.$t("RemarkVerify"),uploadAble:!0,initialTaskId:e.taskId,initialBizKey:e.bizKey,initialInstId:e.instId,onFlowBefore:e.onFlowBefore,onFlowFinish:e.onFlowFinish,onFlowError:e.onFlowError,onFlowResult:e.onFlowResult,componentConf:{history:{visible:!1},attachment:{visible:!1},remark:{visible:e.needRemark}}}})],1)],1)},n=[],o=a("c258"),i=o["a"],c=(a("5a0c5"),a("2877")),l=Object(c["a"])(i,r,n,!1,null,null,null),d=l.exports,u=a("fe07");s["a"].config.productionTip=!1,new s["a"]({i18n:u["a"],render:function(e){return e(d)}}).$mount("#app")},c258:function(e,t,a){"use strict";(function(e){a("4de4"),a("4160"),a("a15b"),a("d81d"),a("a434"),a("a9e3"),a("159b");var s=a("2909"),r=a("5530"),n=(a("96cf"),a("1da1")),o=a("5a0c"),i=a.n(o),c=a("e228"),l=a("1f4f"),d=a("0eb8"),u=a("fa11"),p=a("233a"),m=a("b9f0"),h=a("e60e"),f=a("c276"),b=a("6936"),g=a("35ad"),k=a("73f5");t["a"]={name:"MarketMainChange",components:{FormMode:l["a"],applicant:d["a"],unloadFile:b["a"],unclosedItems:u["a"],aptitudeAndRate:m["a"],Flow:h["d"]},mixins:[c["a"],p["a"]],data:function(){var e=this,t=function(t,a,s){if(e.upFileIsQuired&&0===e.contractBaseInfo.changeorfinishAttach.length)return s(new Error(e.$t("noEmpty")));s()};return{title:this.$t("mainChangeFlowTitle"),userInfo:JSON.parse(localStorage.getItem("user_info")),isEn:"en-US"===localStorage.getItem("local"),processNode:"retail",selfFormData:{},shopNatureCode:"",isDisabled:!1,isMainDisabled:!0,isWuguanDisabled:!0,contractBaseInfo:{applicantName:"",applicantEmail:"",applicantCode:"",applicantMobile:"",applicationDate:"",applicantOrgPath:"",applicantPosition:"",shopCode:"",shopName:"",isSelf:"",shopTypeCode:"",brand:"",currency:"",enterpriseNature:"",contractCode:"",marketName:"",marketType:"",companyName:"",companyEnName:"",shopAddress:"",isNeedSignatoryAttach:"",changeorfinishAttach:[],ifManagement:"",contractBeginDate:"",contractEndDate:"",sn:"",id:""},ruleInline1:{contractCode:[{message:this.$t("noEmpty"),trigger:"blur"}],isNeedSignatoryAttach:[{required:!0,message:this.$t("noEmpty"),trigger:"change"}],changeorfinishAttach:[{validator:t,trigger:"change"}],ifManagement:[{required:!0,message:this.$t("noEmpty"),trigger:"change"}]},ruleInline2:{changeDate:[{type:"date",required:!0,message:this.$t("noEmpty"),trigger:"change"}]},contractDetailInfo:{keyPointOfLaw:"",lawComment:"",changeDate:"",gradeCredentials:"",gradeAppointment:"",gradeGroup:"",gradeProperty:"",gradeIsListed:"",gradeTotalPoints:"",gradeCashierWay:"",gradeRefundPeriod:""},mainChangeDate:"",baseShopInfo:{},shopCodeColumns:[{title:this.$t("shopCode"),key:"shopCode"},{title:this.$t("storeName"),key:"shopName"}],filterItem:"",getListData:k["D"],shopSearchData:{physicalCity:"",shopName:"",shopCode:"",shopNatureCode:""},formDataBaseMarketList:[],oldMarketInfoColumns:[{type:"index",width:100,title:this.$t("SerialNumber"),key:"SerialNumber"},{title:"主体类型",key:"shopBusinessTypeName"},{title:this.$t("marketCnName"),key:"cnName"},{title:this.$t("marketEnName"),key:"enName"},{title:this.$t("businessLicenseNum"),key:"businessLicenseNo"},{width:200,title:this.$t("action"),key:"shopCode",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},on:{click:function(){e.readAndEdit(a.index,"read","old")}}},e.$t("watchView"))])}}],marketInfoColumnsEdit:[{type:"index",width:100,title:this.$t("SerialNumber"),key:"SerialNumber"},{title:"主体类型",key:"shopBusinessTypeName"},{title:this.$t("marketCnName"),key:"cnName"},{title:this.$t("marketEnName"),key:"enName"},{title:this.$t("businessLicenseNum"),key:"businessLicenseNo"},{width:150,title:this.$t("action"),key:"shopCode",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small",disabled:!a.row._checked},on:{click:function(){e.readAndEdit(a.index,"LegalEdit"===e.handelType?"LegalEdit":"edit","new")}}},e.$t("btn_edit")),t("Button",{props:{type:"error",size:"small",disabled:"backFromLegalEdit"===e.processNode||!a.row._checked},style:{marginLeft:"10px"},on:{click:function(){e.remove(a)}}},e.$t("btn_delete"))])}}],marketInfoColumnsDetail:[{type:"index",width:100,title:this.$t("SerialNumber"),key:"SerialNumber"},{title:"主体类型",key:"shopBusinessTypeName"},{title:this.$t("marketCnName"),key:"cnName"},{title:this.$t("marketEnName"),key:"enName"},{title:this.$t("businessLicenseNum"),key:"businessLicenseNo"},{width:150,title:this.$t("action"),key:"shopCode",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},on:{click:function(){e.readAndEdit(a.index,"read","new")}}},e.$t("watchView"))])}}],taskId:"",bizKey:"",instId:"",submitData:{contractBaseInfo:{},marketApproveDetails:[],contractMarketInfos:[],contractDetailInfo:{},oldContractId:""},shopCode:"",validateMainFlag:[],validRequireSuccess:[],isDetail:!1,firstSn:"",firstId:"",groupMark:0,selfProperty:0,isSelfbusiness:!1,enterpriseNature:"",hasChooseShop:!1,hasHistoryApprove:!1,actualOpenDate:"",isContractApprove:!1,isLegalApprove:!1,needRemark:!1,currentShopCode:"",upFileIsQuired:!1,flowType:"marketMainChange",isMarketMainChange:!0,formDataOldBaseMarketList:[],isAddMarket:!1,hasHistoryApproveSn:"",hasHistoryApproveDefKey:"",hasHistoryApproveInstId:"",isPropertyRisk:!1,originChangeFormData:{},ifManagement:"",changeStoreList:[{code:"0",type:"yesorno",valueCN:"只变更主体",valueEn:"YES",parentCode:"",description:"是否",orderBy:0,id:445,value:"只变更主体"},{code:"1",type:"yesorno",valueCN:"只变更物管",valueEn:"NO",parentCode:"446",description:"是否",orderBy:1,id:446,value:"只变更物管"},{code:"2",type:"yesorno",valueCN:"主体、物管都变更",valueEn:"NO",parentCode:"446",description:"是否",orderBy:1,id:446,value:"主体、物管都变更"}],isExistSame:!1,dateIsValidate:!1}},computed:{position:function(){return this.isEN?this.userInfo.positionEn:this.userInfo.positionCn},orgPathName:function(){return this.isEN?this.userInfo.orgPathNameEn:this.userInfo.orgPathNameCn},dateTime:function(){return i()(new Date).format("YYYY-MM-DD h:mm:ss")},fileColumn:function(){return{required:!0,validOk:!0,enable:this.isUploadDasabled,multiple:!0,files:this.contractBaseInfo.changeorfinishAttach}},isUploadDasabled:function(){return"retail"===this.processNode||"retailEdit"===this.processNode||"backFromContractEdit"===this.processNode},isRetailApply:function(){return"retail"===this.processNode||"retailEdit"===this.processNode||"backFromLegalEdit"===this.processNode},marketInfoColumns:function(){return"retailEdit"===this.processNode||"retail"===this.processNode||"backFromLegalEdit"===this.processNode||"backFromContractEdit"===this.processNode?this.marketInfoColumnsEdit:this.marketInfoColumnsDetail}},watch:{processNode:{handler:function(e){"retail"===this.processNode||"retailEdit"===this.processNode||"backFromContractEdit"===this.processNode?this.isDisabled=!1:this.isDisabled=!0},immediate:!0},"contractBaseInfo.isNeedSignatoryAttach":{handler:function(e){this.isRetailApply&&Number(e)?this.upFileIsQuired=!0:this.upFileIsQuired=!1},immediate:!0},"contractDetailInfo.changeDate":{handler:function(e){this.mainChangeDate=i()(e).format("YYYY-MM-DD")},immediate:!1},"contractBaseInfo.ifManagement":{handler:function(e){this.ifManagement=e}}},created:function(){var e=this.$router2.getQuery(),t=e.taskId,a=e.bizKey,s=e.instId,r=e.nodeName;this.taskId=t,this.bizKey=a,this.instId=s,this.nodeName=r,a&&this.getContractDataFn(),this.judgePageType()},methods:{judgePageType:function(){var t=this.$router2.getQuery(),a=t.pageId;a||e.isEmpty(this.$router2.getQuery())||(this.processNode="retailEdit"),"MarketMainChangeView"===a&&(this.isDetail=!0,this.processNode="retailView"),"MarketMainChangeApprove"===a&&"合同组审核"===this.nodeName&&(this.processNode="contract",this.isContractApprove=!0,this.needRemark=!0),"MarketMainChangeApproveView"===a&&"合同组审核"===this.nodeName&&(this.isDetail=!0,this.processNode="contract"),"MarketMainChangeApprove"===a&&"法务组审核"===this.nodeName&&(this.needRemark=!0,this.isLegalApprove=!0,this.processNode="legal",this.needRemark=!0),"MarketMainChangeApproveView"===a&&"法务组审核"===this.nodeName&&(this.isDetail=!0,this.isLegalApprove=!0,this.processNode="legal"),"MarketMainBackFromContract"===a&&(this.processNode="backFromContractEdit",this.handelType="ContractEdit"),"MarketMainBackFromLegal"===a&&(this.processNode="backFromLegalEdit",this.handelType="LegalEdit")},storeCodeSelect:function(t){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var n,o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,Object(k["G"])({shopCode:t.shopCode});case 2:if(n=s.sent,500!==n.code){s.next=6;break}return a.$Message.info({content:n.message||"",duration:a.$global.duration,closable:!0}),s.abrupt("return",!1);case 6:return a.shopCode=t.shopCode,o={sn:"",shopCode:t.shopCode},s.next=10,Object(g["d"])(o);case 10:i=s.sent,i&&200===i.code?e.isEmpty(i.data)?a.$Message.error({content:"该店铺无数据！",duration:a.$global.duration,closable:!0}):(i.data.baseShopInfo.baseMarketList.sort((function(e,t){return e.ranking?t.ranking?Number(e.ranking)-Number(t.ranking):-1:1})),a.originChangeFormData=e.cloneDeep(i.data),a.selfFormData=i.data,Object(f["c"])(i.data.contractBaseInfo,a.contractBaseInfo),a.contractBaseInfo.shopCode=i.data.baseShopInfo.shopCode,a.contractBaseInfo.shopName=i.data.baseShopInfo.shopName,a.contractBaseInfo.isSelf=i.data.baseShopInfo.isSelf+"",a.contractBaseInfo.shopNatureCode=i.data.baseShopInfo.shopNatureCode,a.contractBaseInfo.brand=i.data.baseShopInfo.brand,a.contractBaseInfo.companyName=i.data.baseShopInfo.companyName,a.contractBaseInfo.marketName=i.data.baseShopInfo.marketName,a.contractBaseInfo.currency=i.data.currency,a.isSelfbusiness=1===Number(i.data.baseShopInfo.isSelf),a.shopNatureCode=i.data.baseShopInfo.shopNatureCode,a.enterpriseNature=i.data.contractBaseInfo.enterpriseNature,a.formData.oldBaseMarketList=i.data.baseShopInfo.baseMarketList.map((function(e){return Object(r["a"])({shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})),a.formData.baseMarketList=a.originChangeFormData.baseShopInfo.baseMarketList.map((function(e){return Object(r["a"])({_checked:!1,shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})),a.submitData.oldContractId=i.data.contractBaseInfo.id,a.hasChooseShop=!0,a.currentShopCode=i.data.contractBaseInfo.shopCode,a.getHistoryApproveInfoFn(i.data.contractBaseInfo.shopCode)):i&&500===i.code&&a.$Message.error({content:i.message,duration:a.$global.duration,closable:!0});case 12:case"end":return s.stop()}}),s)})))()},getContractDataFn:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(g["d"])({sn:e.bizKey});case 2:a=t.sent,200===a.code&&(a.data.baseShopInfo.baseMarketList.sort((function(e,t){return e.ranking?t.ranking?Number(e.ranking)-Number(t.ranking):-1:1})),a.data.contractMarketInfos.sort((function(e,t){return e.ranking?t.ranking?Number(e.ranking)-Number(t.ranking):-1:1})),e.shopCode=a.data.contractBaseInfo.shopCode,e.isSelfbusiness="1"===a.data.contractBaseInfo.isSelf,e.selfFormData=a.data,e.firstSn=a.data.contractBaseInfo.sn,e.firstId=a.data.contractBaseInfo.id,e.contractBaseInfo=a.data.contractBaseInfo,e.shopNatureCode=a.data.baseShopInfo.shopNatureCode,e.contractDetailInfo=a.data.contractDetailInfo,s=a.data.contractDetailInfo.changeDate,e.mainChangeDate=e.contractDetailInfo.changeDate=s?i()(s).format("YYYY-MM-DD"):"",e.formData.oldBaseMarketList=a.data.baseShopInfo.baseMarketList.map((function(e){return Object(r["a"])({shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})),n=a.data.contractBaseInfo.ifManagement,e.formData.baseMarketList=a.data.contractMarketInfos.map((function(e){e.hasOwnProperty("baseShopInfo")&&delete e.baseShopInfo;var t=!1;switch(n){case"0":t=1===e.shopBusinessType;break;case"1":t=1!==e.shopBusinessType;break;case"2":t=!0;break}return Object(r["a"])({_checked:t,shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})),e.submitData.oldContractId=a.data.contractBaseInfo.id,e.hasChooseShop=!0,e.currentShopCode=a.data.contractBaseInfo.shopCode,e.getHistoryApproveInfoFn(a.data.contractBaseInfo.shopCode),a.data.marketApproveDetails.forEach((function(t){"cqxx"===t.approveItemCode&&"cqxx_1"===t.approveLevelId&&(e.isPropertyRisk=!0)})),e.getOriginalStoreInfo(a.data.contractBaseInfo.shopCode));case 4:case"end":return t.stop()}}),t)})))()},getOriginalStoreInfo:function(t){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var n,o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return n={sn:"",shopCode:t},s.next=3,Object(g["d"])(n);case 3:o=s.sent,o&&200===o.code&&(o.data.baseShopInfo.baseMarketList.sort((function(e,t){return e.ranking?t.ranking?Number(e.ranking)-Number(t.ranking):-1:1})),i=o.data.baseShopInfo.baseMarketList.map((function(e){return Object(r["a"])({_checked:!1,shopBusinessTypeName:1===e.shopBusinessType?"主体商场":"物管商场"},e)})).sort((function(e,t){return e.ranking?t.ranking?Number(e.ranking)-Number(t.ranking):-1:1})),a.baseMarketListCopy=e.cloneDeep(i),o.data.contractBaseInfo.ifManagement="",a.originChangeFormData=o.data);case 5:case"end":return s.stop()}}),s)})))()},changeIsNeedSignatoryAttach:function(e){Number(e)?(this.upFileIsQuired=!0,this.$refs.contractBaseInfo.validateField("changeorfinishAttach")):(this.upFileIsQuired=!1,this.fileColumn.validOk=!0,this.$refs.contractBaseInfo.validateField("changeorfinishAttach"))},changeIsOnlyChangeWuGuan:function(e){switch(this.ifManagement=e,e){case"0":this.formData.baseMarketList=this.originChangeFormData.baseShopInfo.baseMarketList.map((function(e){return e.shopBusinessTypeName=1===e.shopBusinessType?"主体商场":"物管商场",e._checked=1===Number(e.shopBusinessType),e}));break;case"1":this.formData.baseMarketList=this.originChangeFormData.baseShopInfo.baseMarketList.map((function(e){return e.shopBusinessTypeName=1===e.shopBusinessType?"主体商场":"物管商场",e._checked=1!==Number(e.shopBusinessType),e}));break;case"2":this.formData.baseMarketList=this.originChangeFormData.baseShopInfo.baseMarketList.map((function(e){return e.shopBusinessTypeName=1===e.shopBusinessType?"主体商场":"物管商场",e._checked=!0,e}));break}},updateFile:function(e){var t;(t=this.contractBaseInfo.changeorfinishAttach).push.apply(t,Object(s["a"])(e.files)),this.$refs.contractBaseInfo.validateField("changeorfinishAttach")},deleteFile:function(e){this.contractBaseInfo.changeorfinishAttach.splice(e.fileIndex,1),this.$refs.contractBaseInfo.validateField("changeorfinishAttach")},linkToHistoryApprove:function(){var e=this.$router2.resolve.call(this,{path:this.hasHistoryApproveUrl,query:{bizKey:this.hasHistoryApproveSn,pageFrom:"alreadyDone",defKey:this.hasHistoryApproveDefKey,instId:this.hasHistoryApproveInstId}});window.open(e,"_blank")},getHistoryApproveInfoFn:function(t){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,Object(g["e"])({shopCode:t,sn:a.bizKey});case 2:r=s.sent,200!==r.code||e.isEmpty(r.data)||(a.hasHistoryApprove=!0,a.hasHistoryApproveUrl=r.data.url,a.hasHistoryApproveSn=r.data.sn,a.hasHistoryApproveDefKey=r.data.defKey,a.hasHistoryApproveInstId=r.data.instId);case 4:case"end":return s.stop()}}),s)})))()},validateChangeDate:function(e){var t=this;console.log(this.contractDetailInfo.changeDate),e?this.$refs.pactPeriodAndchangeTime.validate((function(e){e?(t.submitData.contractDetailInfo.changeDate=t.contractDetailInfo.changeDate,t.dateIsValidate=!0):(t.$Message.error({content:t.$t("requiredItemsNone"),duration:t.$global.duration,closable:!0}),t.dateIsValidate=!1)})):(this.submitData.contractDetailInfo.changeDate=this.contractDetailInfo.changeDate,this.dateIsValidate=!0)},savePactMainChangeFn:function(t){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var r,n,o,i,c,l,d,u,p;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if("retail"===a.processNode&&a.saveRetailInfo(),r=e.cloneDeep(a.contractBaseInfo),n=[],r.changeorfinishAttach&&r.changeorfinishAttach.length&&(n=r.changeorfinishAttach.map((function(e){return e.id}))),r.changeorfinishAttach=n.join(","),a.submitData.contractBaseInfo=r,"retail"===a.processNode&&(a.firstSn?(a.submitData.contractBaseInfo.sn=a.firstSn,a.submitData.contractBaseInfo.id=a.firstId):(a.submitData.contractBaseInfo.sn="",a.submitData.contractBaseInfo.id="")),a.validateChangeDate(t),!t){s.next=15;break}if(a.validRequireSuccess=[],a.validateMainFlag=[],a.$refs["contractBaseInfo"].validate((function(e){if(!e)return a.validRequireSuccess.push("1"),a.$Message.error({content:a.$t("requiredItemsNone"),duration:a.$global.duration,closable:!0}),!1})),o=a.checkIsHasMain(a.formData.baseMarketList),o){s.next=15;break}return s.abrupt("return",!1);case 15:if(i=["businessLicense","openingPermit","landUsePermits","constructionPermits","houseOwnership","ortherPermits","actualBusinessLicense","actualOpeningPermit","actualLandUsePermits","actualConstructionPermits","actualHouseOwnership","actualOrtherPermits","actualAuthCertificate","authCertificate"],c=["settledBrandsCode"],l=e.cloneDeep(a.formData.baseMarketList),d="",l.forEach((function(e){1===Number(e.isActualmarketRight)&&(d=e.actualMarketCode)})),d=a.isExistSame?d:l[0].actualMarketCode,a.submitData.contractMarketInfos=l.map((function(e){for(var t=0;t<i.length;t++)e[i[t]]&&e[i[t]].length?(e[i[t]]=e[i[t]].map((function(e){return e.id})),e[i[t]]=e[i[t]].join(",")):e[i[t]]="";for(var a=0;a<c.length;a++)e[c[a]]&&Array.isArray(e[c[a]])&&e[c[a]].length&&(e[c[a]]=e[c[a]].join(",")),Array.isArray(e[c[a]])&&!e[c[a]].length&&(e[c[a]]="");return 1===Number(e.isActualmarketRight)&&(e.baseBankInfoList=e.baseBankInfoList.filter((function(e){return 2===Number(e.belongsType)}))),e.isNew&&(e.actualMarketCode=d),e})),a.$refs.aptitudeAndRate.emitData(),console.log(JSON.stringify(a.submitData)),!t||a.validRequireSuccess.length||!a.dateIsValidate||a.validateMainFlag.length){s.next=35;break}return s.next=27,Object(g["f"])(a.submitData);case 27:if(u=s.sent,200!==u.code){s.next=31;break}return a.firstSn||(a.firstSn=u.data.sn,a.firstId=u.data.id),s.abrupt("return",u);case 31:if(500!==u.code){s.next=33;break}return s.abrupt("return",u);case 33:s.next=44;break;case 35:if(t){s.next=44;break}return s.next=38,Object(g["f"])(a.submitData);case 38:if(p=s.sent,200!==p.code){s.next=42;break}return a.firstSn||(a.firstSn=p.data.sn,a.firstId=p.data.id),s.abrupt("return",p);case 42:if(500!==p.code){s.next=44;break}return s.abrupt("return",p);case 44:case"end":return s.stop()}}),s)})))()},saveRetailInfo:function(){this.contractBaseInfo.applicantName=this.userInfo.userName,this.contractBaseInfo.applicantPosition=this.position,this.contractBaseInfo.applicantEmail=this.userInfo.email,this.contractBaseInfo.applicantCode=this.userInfo.userCode,this.contractBaseInfo.applicantMobile=this.userInfo.mobile,this.contractBaseInfo.applicationDate=this.dateTime,this.contractBaseInfo.applicantOrgPath=this.orgPathName,this.contractBaseInfo.applicantOrgPathCode=this.userInfo.orgPathCode},groupPropertyLevel:function(e){if(e&&e.length)for(var t=0;t<e.length;t++){if(1===e[t].shopBusinessType){switch(Number(e[t].groupLevel)){case 1:this.groupMark=100;break;case 2:this.groupMark=70;break;case 3:this.groupMark=40;break;default:this.groupMark=0;break}switch(Number(e[t].isPropertyRight)){case 1:this.selfProperty=100;break;case 0:this.selfProperty=0;break}}break}},submitFormData:function(e,t,a){"apitude"===t&&(Object.assign(this.submitData.marketApproveDetails,e),Object.assign(this.submitData.contractDetailInfo,a)),"rateMark"===t&&Object.assign(this.submitData.contractDetailInfo,e)},onFlowBefore:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=e.cmdType,r=e.cmdId,"processStatus"===s){a.next=28;break}if("legal"!==t.processNode||""!==t.$refs.flow.$data.taskComment||!t.isPropertyRisk){a.next=5;break}return t.$Message.warning({content:"请输入审核意见",duration:t.$global.duration,closable:!0}),a.abrupt("return",{interrupted:!0,value:t.bizKey});case 5:if(t.handleSpinCustom(),!("saveTaskDraft"===s||"submit"===s&&"submit"===r||"general"===s&&"needLegal"===r||"legal"!==t.processNode&&"general"===s&&"rollBackTask"===r||"general"===s&&"goBackRetail2"===r||"general"===s&&"HandleCommand_4"===r||"submit"===s&&"HandleCommand_3"===r)){a.next=28;break}if(!("submit"===s&&"submit"===r||"general"===s&&"reSubmit"===r||"submit"===s&&"HandleCommand_3"===r)){a.next=13;break}return a.next=10,t.savePactMainChangeFn(1);case 10:n=a.sent,a.next=16;break;case 13:return a.next=15,t.savePactMainChangeFn(0);case 15:n=a.sent;case 16:if(!n){a.next=26;break}if(200!==n.code){a.next=22;break}return o=t.bizKey?t.bizKey:t.firstSn,a.abrupt("return",{interrupted:!1,value:o});case 22:t.$Spin.hide(),t.$Message.error({content:n.message,duration:t.$global.duration,closable:!0});case 24:a.next=27;break;case 26:t.$Spin.hide();case 27:return a.abrupt("return",{interrupted:!0});case 28:return a.abrupt("return",{interrupted:!1});case 29:case"end":return a.stop()}}),a)})))()},onFlowError:function(e){this.$Spin.hide(),this.$Message.error({content:e,duration:this.$global.duration,closable:!0})},onFlowFinish:function(){},onFlowResult:function(e){var t=this,a=(e.instId,e.taskId,e.cmdId),s=e.cmdType;return this.$Spin.hide(),"saveTaskDraft"===s||"general"===s&&"HandleCommand_4"===a?(this.$rcmMessage.show({content:this.$t("temporarySuccess")}),!1):"submit"===s?(this.$rcmMessage.show({onOk:function(){t.$router2.push.call(t,"/wflow/my")}}),!1):"submit"!==s&&"saveTaskDraft"!==s&&"processStatus"!==s?(this.$rcmMessage.show({onOk:function(){t.$router2.push.call(t,"/wflow/processed")}}),!1):void 0},handleSpinCustom:function(){this.$Spin.show({render:function(e){return e("div",[e("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),e("div","Loading")])}})}},mounted:function(){document.title=this.title}}}).call(this,a("2ef0"))},cca1:function(e,t,a){},fa11:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Form",{staticClass:"form",attrs:{"label-width":120,"label-position":"right",inline:""}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("receivables")}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.unclosedFormData.receivables,callback:function(t){e.$set(e.unclosedFormData,"receivables",t)},expression:"unclosedFormData.receivables"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("receivableMarketCashPledge")}},[a("Input",{attrs:{disabled:"",size:"large"},model:{value:e.unclosedFormData.receivableMarketCashPledge,callback:function(t){e.$set(e.unclosedFormData,"receivableMarketCashPledge",t)},expression:"unclosedFormData.receivableMarketCashPledge"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("receivableMarketInvoice")}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.unclosedFormData.receivableMarketInvoice,callback:function(t){e.$set(e.unclosedFormData,"receivableMarketInvoice",t)},expression:"unclosedFormData.receivableMarketInvoice"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("prepayMarketCost")}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.unclosedFormData.prepayMarketCost,callback:function(t){e.$set(e.unclosedFormData,"prepayMarketCost",t)},expression:"unclosedFormData.prepayMarketCost"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:"应付商场保证金"}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.unclosedFormData.receivableMarketCashDeposit,callback:function(t){e.$set(e.unclosedFormData,"receivableMarketCashDeposit",t)},expression:"unclosedFormData.receivableMarketCashDeposit"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("storePettyCash")}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.unclosedFormData.storePettyCash,callback:function(t){e.$set(e.unclosedFormData,"storePettyCash",t)},expression:"unclosedFormData.storePettyCash"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1)],1),a("Row",{staticStyle:{width:"100%"}},[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("uncloseAccountDiff")}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.unclosedFormData.uncloseAccountDiff,callback:function(t){e.$set(e.unclosedFormData,"uncloseAccountDiff",t)},expression:"unclosedFormData.uncloseAccountDiff"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"form-item",attrs:{label:e.$t("unreasonableCost")}},[a("Input",{attrs:{size:"large",disabled:""},model:{value:e.unclosedFormData.unreasonableCost,callback:function(t){e.$set(e.unclosedFormData,"unreasonableCost",t)},expression:"unclosedFormData.unreasonableCost"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v(e._s(e.$t("element")))])])],1)],1),a("Col",{attrs:{span:"8"}})],1)],1)},r=[],n=(a("4160"),a("b64b"),a("07ac"),a("159b"),a("96cf"),a("1da1")),o=a("73f5"),i={name:"uncloseItems",data:function(){return{unclosedFormData:{receivables:"",receivableMarketCashPledge:"",receivableMarketInvoice:"",prepayMarketCost:"",receivableMarketCashDeposit:"",storePettyCash:"",uncloseAccountDiff:"",unreasonableCost:""},unclosedArr:[{receivables:"1122020001"},{receivableMarketCashPledge:"1221030001"},{receivableMarketInvoice:"1221050002"},{prepayMarketCost:"1501010001"},{receivableMarketCashDeposit:"2241040001"},{storePettyCash:"1221040001"}],unclosedArr2:[{uncloseAccountDiff:"剩余结算差异"},{unreasonableCost:"不合理费用"}]}},props:{shopCode:{type:String,required:!1,default:function(){return""}},bizKey:{type:String,required:!1,default:function(){return""}}},watch:{shopCode:{handler:function(e){this.fetchUnclosedItem(e)},immediate:!0}},methods:{fetchUnclosedItem:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={shopCode:e.shopCode,sn:e.bizKey},t.next=3,Object(o["C"])(a);case 3:s=t.sent,r=[],200===s.code&&(r=s.data.returnList),r.forEach((function(t){e.unclosedArr.forEach((function(a){t.accountCode&&t.accountCode===Object.values(a)[0]&&(e.unclosedFormData[Object.keys(a)[0]]=t.money)})),e.unclosedArr2.forEach((function(a){t.accountCode||t.accountName!==Object.values(a)[0]||(e.unclosedFormData[Object.keys(a)[0]]=t.money)}))}));case 7:case"end":return t.stop()}}),t)})))()}},mounted:function(){}},c=i,l=a("2877"),d=Object(l["a"])(c,s,r,!1,null,null,null);t["a"]=d.exports}});