(function(e){function t(t){for(var o,s,a=t[0],c=t[1],l=t[2],d=0,f=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(o=!1)}o&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},i={"todo/list":0},r=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;r.push([62,"chunk-vendors","chunk-common"]),n()})({"33b4":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("cc00"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("FlowStatusModal",{attrs:{defKey:e.flowStatus.defKey,instId:e.flowStatus.instId},model:{value:e.flowStatus.show,callback:function(t){e.$set(e.flowStatus,"show",t)},expression:"flowStatus.show"}}),n("Card",{staticClass:"margin15",attrs:{title:e.$t("QueryCondition")}},[n("Form",{attrs:{"label-width":100,inline:""}},[e._l(e.formDynamic,(function(t,o){return n("FormItem",{key:o,staticClass:"form-item2",attrs:{label:e.$t(t.key),prop:"items."+o+".value"}},["Input"===t.type?n("Input",{attrs:{clearable:"",placeholder:e.$t("wran_input")},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"item.value"}}):n("Select",{attrs:{clearable:""},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"item.value"}},e._l(t.options,(function(t){return n("Option",{key:t.id,attrs:{value:t.code}},[e._v(e._s(e.isEn?t.valueEn:t.valueCN))])})),1)],1)})),n("FormItem",{staticClass:"form-item2",attrs:{label:e.$t("flowReceiveTime")}},[n("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange",transfer:"",placement:"bottom-end",placeholder:e.$t("picker_select_date")},on:{"on-change":e.onReceiveDateChange}})],1),e.showVersionNode?n("FormItem",{staticClass:"form-item2",attrs:{label:e.$t("flowVersion")}},[n("Select",{attrs:{clearable:""},on:{"on-change":e.onVersionChange},model:{value:e.queryCondition.version,callback:function(t){e.$set(e.queryCondition,"version",t)},expression:"queryCondition.version"}},e._l(e.versions,(function(t){return n("Option",{key:t.version,attrs:{value:t.version}},[e._v(e._s(t.versionName))])})),1)],1):e._e(),e.showVersionNode?n("FormItem",{staticClass:"form-item2",attrs:{label:e.$t("flowNode")}},[n("Select",{attrs:{clearable:""},on:{"on-change":e.onNodeChange},model:{value:e.queryCondition.nodeId,callback:function(t){e.$set(e.queryCondition,"nodeId",t)},expression:"queryCondition.nodeId"}},e._l(e.nodes,(function(t){return n("Option",{key:t.nodeId,attrs:{value:t.nodeId}},[e._v(e._s(t.name))])})),1)],1):e._e()],2)],1),e.showVCVersionNode?n("Card",{attrs:{title:"版本控制"}},[n("Form",{attrs:{"label-width":100,inline:""}},[n("div",{staticStyle:{width:"46%",display:"flex"}},[n("FormItem",{staticStyle:{width:"50%"},attrs:{label:e.$t("flowVersion")}},[n("Select",{attrs:{clearable:""},on:{"on-change":e.onVCVersionChange},model:{value:e.versionControl.version,callback:function(t){e.$set(e.versionControl,"version",t)},expression:"versionControl.version"}},e._l(e.versionControl.versions,(function(t){return n("Option",{key:t.version,attrs:{value:t.version}},[e._v(e._s(t.versionName))])})),1)],1),n("FormItem",{staticStyle:{width:"50%"},attrs:{label:e.$t("flowNode")}},[n("Select",{attrs:{clearable:""},on:{"on-change":e.onVCNodeChange},model:{value:e.versionControl.nodeId,callback:function(t){e.$set(e.versionControl,"nodeId",t)},expression:"versionControl.nodeId"}},e._l(e.versionControl.nodes,(function(t){return n("Option",{key:t.nodeId,attrs:{value:t.nodeId}},[e._v(e._s(t.nodeName))])})),1)],1)],1)])],1):e._e(),n("div",{staticStyle:{"margin-bottom":"8px"}},[n("Button",{staticStyle:{marginRight:"8px"},attrs:{type:"primary"},on:{click:e.getToDoList}},[e._v(e._s(e.$t("query")))]),e.isBatch?[e._l(e.cmds,(function(t){return n("Button",{key:t.cmdId,staticStyle:{marginRight:"8px"},attrs:{type:"primary"},on:{click:function(n){return e.execute(t)}}},[e._v(e._s(t.cmdName))])})),e.isBatch?n("Tag",{attrs:{color:"green"}},[e._v("先勾选 “下表” 中要进行审批的行，再使用左侧按钮审批")]):n("Tag",{attrs:{color:"green"}},[e._v("先点击 “下表” 中的一行，再使用左侧按钮审批")])]:e._e()],2),n("Table",{ref:"selection",staticClass:"margin15",attrs:{border:"",columns:e.tableColumns,"highlight-row":!e.isBatch,data:e.todos,loading:e.loading},on:{"on-selection-change":e.onSelectionChange,"on-select-cancel":e.onSelectCancel,"on-select-all":e.onSelectAll,"on-select":e.onSelect,"on-current-change":e.onSingleSelect}}),n("Page",{staticStyle:{"margin-top":"15px"},attrs:{total:e.total,"show-elevator":"","show-sizer":""},on:{"on-change":e.onPageChange,"on-page-size-change":e.onPageSizeChange}})],1)},r=[],s=(n("7db0"),n("c740"),n("4160"),n("a15b"),n("d81d"),n("b0c0"),n("ac1f"),n("1276"),n("c7cd"),n("159b"),n("b85c")),a=n("5530"),c=(n("96cf"),n("1da1")),l=n("3835"),u=(n("b383"),n("e60e")),d=n("7e1e"),f=n("66df"),h=function(e){return f["a"].request({url:"/api/workflow/business/invest/getToDoList",method:"post",data:e})},v=function(e){return f["a"].request({url:"/api/workflow/business/storeCode/getToDoList",method:"post",data:e})},m=function(e){return f["a"].request({url:"/api/workflow/business/storeCodeChange/getToDoList",method:"post",data:e})},p=function(e){return f["a"].request({url:"/api/workflow/business/addMarket/getToDoList",method:"post",data:e})},g=function(e){return f["a"].request({url:"/api/workflow/business/marketInfoChange/getToDoList",method:"post",data:e})},y=function(e){return f["a"].request({url:"/api/workflow/business/marketMainChange/getToDoList",method:"post",data:e})},w=function(e){return f["a"].request({url:"/api/workflow/business/changeStoreAddress/getToDoList",method:"post",data:e})},C=function(e){var t=e.defKey;return"rcm_investment"===t||"rcm_investment_recmov"===t?h(e):"rcm_eshopcode"===t||"rcm_storecode"===t?v(e):"rcm_storechange"===t||"rcm_eshopchange"===t?m(e):"rcm_storecode_market"===t?p(e):"rcm_contract_market"===t?g(e):"rcm_changeaddress"===t?w(e):"rcm_contract_main_market"===t?y(e):void 0},b=n("4091"),_={components:{FlowStatusModal:u["b"]},data:function(){return{isEn:"en-US"===localStorage.getItem("local"),name:"",loading:!0,total:0,formDynamic:[],columns:[],queryCondition:{defKey:"rcm_investment",nodeId:"",pageNum:1,pageSize:10,receiveTime:[],receiveTimeBegin:"2019-01-01",receiveTimeEnd:"2120-01-01",sortBy:"RECEIVE_TIME",sortDirection:"desc",version:""},investTypeDict:[],versions:[],nodes:[],cmds:[],todos:[],versionControl:{versions:[],nodes:[],version:"",nodeId:""},selection:[],showVersionNode:!0,showVCVersionNode:!0,flowStatus:{show:!1,defKey:"",instId:""},isBatch:!0,isFixed:!1,routerName:"",brandList:[],titleName:""}},computed:{tableColumns:function(){var e=this,t=this.columns.map((function(t,n){var o=t.key,i=t.width,r={title:e.$t(o),key:o};return i&&(r.width=200),n||(r.width=216),r}));if(this.isBatch){var n={type:"selection",width:60,align:"center"};this.isFixed&&(n.fixed="left"),t.push(n)}var o={title:this.$t("action"),key:"action",width:100,align:"center",render:function(t,n){return t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showFlowStatus(n.row)}}},e.$t("instStatus"))}};this.isFixed&&(o.fixed="right"),t.push(o);var i={title:this.$t("bizKey"),key:"bizKey",width:200,align:"center",render:function(t,n){return t("div",{style:{color:"#2b85e4",cursor:"pointer"},on:{click:function(){e.go2Approve(n.row)}}},n.row.bizKey)}};return this.isFixed&&(i.fixed="left"),t.unshift(i),t},investTypeList:function(){var e=this;return this.investTypeDict.map((function(t){return{value:t.code,label:e.isEn?t.valueEn:t.valueCN}}))}},destroyed:function(){window.removeEventListener("update-list",this.getToDoList,!1)},mounted:function(){var e=this;window.addEventListener("update-list",this.getToDoList,!1);var t=this.$router2.getQuery(),n=t.name,o=t.defKey;this.titleName=n,this.queryCondition.defKey=o,"rcm_eshopcode"===this.queryCondition.defKey&&(this.routerName="eshop-approve"),this.getToDoList().then((function(){e.loading=!1})),this.fetchInvestTypeDict(),Object(b["k"])({defKey:this.queryCondition.defKey}).then((function(t){if(200===t.code){var n=t.data,o=n&&1===n.length,i=o&&1===n[0].nodes.length;if(e.versions=n,o){var r=n[0].version,s=n[0].nodes;e.queryCondition.version=r,e.nodes=s,i&&(e.queryCondition.nodeId=s[0].nodeId,e.showVersionNode=!1)}}else e.$Message.error(t.message)})),Object(b["f"])(this.queryCondition.defKey).then((function(t){if(200===t.code){var n=t.data,o=n.condition,i=n.columns,r=n.fixed;e.formDynamic=o,e.columns=i,e.isFixed=r}}))},methods:{showFlowStatus:function(e){var t=e.defKey,n=e.instId;this.flowStatus={defKey:t,instId:n,show:!0}},go2Approve:function(e){this.$router2.push.call(this,{path:e.formUri,query:e})},onPageChange:function(e){var t=this;this.updateSelection([]),this.queryCondition.pageNum=e,this.$nextTick((function(){return t.getToDoList()}))},onPageSizeChange:function(e){var t=this;this.updateSelection([]),this.queryCondition.pageSize=e,this.$nextTick((function(){return t.getToDoList()}))},onReceiveDateChange:function(e){var t=Object(l["a"])(e,2),n=t[0],o=t[1];this.queryCondition.receiveTimeBegin=n,this.queryCondition.receiveTimeEnd=o},onVersionChange:function(e){if(e){var t=this.versions.find((function(t){return t.version===e}));this.nodes=t.nodes}else this.nodes=[],this.queryCondition.nodeId=""},onNodeChange:function(e){e||(this.queryCondition.nodeId="")},onVCVersionChange:function(e){if(e){var t=this.versionControl.versions.find((function(t){return t.version===e}));this.versionControl.nodes=t.nodes}else this.versionControl.nodes=[]},onVCNodeChange:function(e){if(e){var t=this.versionControl.nodes.find((function(t){return t.nodeId===e}));this.cmds=t.cmds}else this.cmds=[]},fetchInvestTypeDict:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$Loading.start(),t.prev=1,t.next=4,Object(d["a"])("invest_type");case 4:n=t.sent,200===n.code&&(e.investTypeDict=n.data),e.$Loading.finish(),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.$Message.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},getToDoList:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,o,i,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},e.formDynamic.forEach((function(e){var t=e.key,o=e.value;n[t]=o})),t.next=4,C(Object(a["a"])(Object(a["a"])({},e.queryCondition),n));case 4:o=t.sent,200===o.code?(e.total=o.total,"rcm_eshopcode"===e.queryCondition.defKey?e.todos=e.codeChangeToLabel(o.data,["brand","shopNature"],e.formDynamic[2].options):e.todos=o.data,i=o.processVos,e.versionControl.versions=i,1===i.length?(r=i[0],e.versionControl.version=r.version,e.versionControl.nodes=r.nodes,1===r.nodes.length?(s=r.nodes[0],e.cmds=s.cmds,e.versionControl.nodeId=s.nodeId,e.isBatch="1"===s.isBatch,e.showVCVersionNode=!1):e.showVCVersionNode=!0):e.showVCVersionNode=!0):e.$Message.error(o.message);case 6:case"end":return t.stop()}}),t)})))()},queryTodoList:function(){return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},onSelectionChange:function(e){this.updateSelection(e)},onSelectCancel:function(e){this.updateSelection(e)},onSelect:function(e,t){var n=this,o=e[0],i=o.version,r=o.nodeId;if(t.version!==i||t.nodeId!==r){this.$Message.warning("版本和节点名称与其他行不一样");var s=this.todos.findIndex((function(e){return e.instId===t.instId}));this.$nextTick((function(){n.$refs.selection.toggleSelect(s)}))}},onSelectAll:function(e){var t=this;if(e&&e.length>0){var n,o=e[0],i=o.version,r=o.nodeId,a=Object(s["a"])(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;if(c.version!==i||c.nodeId!==r){this.$Message.warning("请选择版本和节点名称一样的行！"),this.$nextTick((function(){t.$refs.selection.selectAll(!1),t.updateSelection([])}));break}}}catch(l){a.e(l)}finally{a.f()}}},onSingleSelect:function(e){this.updateSelection([e])},updateSelection:function(e){this.selection=e},codeChangeToLabel:function(e,t,n){for(var o=0;o<e.length;o++)for(var i=0;i<t.length;i++)if(""===e[o][t[i]]){for(var r=e[o][t[i]+"Code"].split(","),s=[],a=0;a<r.length;a++)for(var c=0;c<n.length;c++)r[a]===n[c]["code"]&&s.push(n[c].valueCN);e[o][t[i]]=s.join(",")}return e}}},S=_,k=(n("fdbc6"),n("2877")),I=Object(k["a"])(S,i,r,!1,null,null,null),x=I.exports,T=n("fe07");o["a"].config.productionTip=!1,new o["a"]({i18n:T["a"],render:function(e){return e(x)}}).$mount("#app")},62:function(e,t,n){e.exports=n("33b4")},"80af":function(e,t,n){},fdbc6:function(e,t,n){"use strict";var o=n("80af"),i=n.n(o);i.a}});